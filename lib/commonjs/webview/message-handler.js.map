{"version":3,"names":["_initializeScreenShare","_interopRequireDefault","require","_createScreenShareOffer","_setScreenShareRemoteSDP","_setFullAudioRemoteSDP","_addScreenShareRemoteIceCandidate","_createFullAudioOffer","_stopScreenShare","e","__esModule","default","observePromiseResult","instanceId","webViewRef","sequence","prom","then","result","console","log","current","injectJavaScript","JSON","stringify","catch","exception","error","handleWebviewMessage","event","setCallState","_event$nativeEvent","stringData","nativeEvent","data","parse","method","promise","initializeScreenShare","createFullAudioOffer","arguments","createScreenShareOffer","setScreenShareRemoteSDP","sdp","setFullAudioRemoteSDP","addScreenShareRemoteIceCandidate","stopScreenShare","_default","exports"],"sources":["message-handler.tsx"],"sourcesContent":["import type { MutableRefObject } from 'react';\nimport type { WebView, WebViewMessageEvent } from 'react-native-webview';\nimport initializeScreenShare from '../methods/initializeScreenShare';\nimport createScreenShareOffer from '../methods/createScreenShareOffer';\nimport setScreenShareRemoteSDP from '../methods/setScreenShareRemoteSDP';\nimport setFullAudioRemoteSDP from '../methods/setFullAudioRemoteSDP';\nimport addScreenShareRemoteIceCandidate from '../methods/addScreenShareRemoteIceCandidate';\nimport createFullAudioOffer from '../methods/createFullAudioOffer';\nimport stopScreenShare from '../methods/stopScreenShare';\n\nfunction observePromiseResult(\n  instanceId: Number,\n  webViewRef: MutableRefObject<WebView>,\n  sequence: number,\n  prom: Promise<any>\n) {\n  prom\n    .then((result: any) => {\n      console.log(`[${instanceId}] - Promise ${sequence} resolved!`, result);\n\n      webViewRef.current.injectJavaScript(\n        `window.nativeMethodCallResult(${sequence}, true ${\n          result ? ',' + JSON.stringify(result) : ''\n        });`\n      );\n    })\n    .catch((exception: any) => {\n      console.error(`[${instanceId}] - Promise ${sequence} failed!`, exception);\n      webViewRef.current.injectJavaScript(\n        `window.nativeMethodCallResult(${sequence}, false ${\n          exception ? ',' + JSON.stringify(exception) : ''\n        });`\n      );\n    });\n}\n\nexport function handleWebviewMessage(\n  instanceId: Number,\n  webViewRef: MutableRefObject<any>,\n  event: WebViewMessageEvent,\n  setCallState?: any\n) {\n  const stringData = event?.nativeEvent?.data;\n  const data = JSON.parse(stringData);\n  console.log('handleWebviewMessage - ', instanceId);\n\n  setCallState(data?.method);\n  if (data?.method && data?.sequence) {\n    let promise;\n    switch (data?.method) {\n      case 'initializeScreenShare':\n        promise = initializeScreenShare(instanceId);\n        break;\n      case 'createFullAudioOffer':\n        promise = createFullAudioOffer(\n          instanceId,\n          JSON.stringify(data?.arguments[0])\n        );\n        break;\n      case 'createScreenShareOffer':\n        promise = createScreenShareOffer(\n          instanceId,\n          JSON.stringify(data?.arguments[0])\n        );\n        break;\n      case 'setScreenShareRemoteSDP':\n        promise = setScreenShareRemoteSDP(instanceId, data?.arguments[0].sdp);\n        break;\n      case 'setFullAudioRemoteSDP':\n        promise = setFullAudioRemoteSDP(instanceId, data?.arguments[0].sdp);\n        break;\n      case 'addRemoteIceCandidate':\n        promise = addScreenShareRemoteIceCandidate(\n          instanceId,\n          JSON.stringify(data?.arguments[0])\n        );\n        break;\n      case 'stopScreenShare':\n        promise = stopScreenShare(instanceId);\n        break;\n      default:\n        throw `[${instanceId}] - Unknown method ${data?.method}`;\n    }\n    observePromiseResult(instanceId, webViewRef, data.sequence, promise);\n  } else {\n    console.log(`[${instanceId}] - Ignoring unknown message: $stringData`);\n  }\n}\n\nexport default { handleWebviewMessage };\n"],"mappings":"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","ignoreList":[]}